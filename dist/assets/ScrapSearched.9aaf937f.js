import{u as K,b as c,D as k,R as b,K as q,H as W,W as P,j as a,a as s,d as o,v as y,x as F,M as D,E as Q}from"./index.61613632.js";import{a as V,A as Y}from"./index.esm.e6574437.js";import{T as I,a as v,I as R,c as _,b as J}from"./index.esm.5f8e3b5d.js";/* empty css               */E(2);E(3);function E(n){if(typeof n!="number"||Number.isNaN(n)||n<1||n===Number.POSITIVE_INFINITY)throw new Error("`"+n+"` is not a valid argument for `n-gram`");return N;function N(d){var h=[],m,g;if(d==null||(g=d.slice?d:String(d),m=g.length-n+1,m<1))return h;for(;m--;)h[m]=g.slice(m,m+n);return h}}const ae=n=>{const{state:N}=K(),[d,h]=c.exports.useState(Array()),[m,g]=c.exports.useState(Array()),[B,T]=c.exports.useState(Array()),[f,j]=c.exports.useState(Object()),[w,H]=c.exports.useState(Array()),[O,L]=c.exports.useState(Boolean(!0)),[C,x]=c.exports.useState(Object()),[S,A]=c.exports.useState(Object()),G=k(o,"scraps");c.exports.useEffect(()=>{d.length&&b(G,e=>{e.docs.map(u=>d.forEach(t=>{(u.data().tokenMap.includes(t)||u.data().languages.includes(N)||u.data().others.includes(N))&&g(i=>[...i,u.data()])}))})},[d]),c.exports.useEffect(()=>{const e=Array.from(new Map(m.map(u=>[u.id,u])).values());T(e)},[m]);const M=(e,u)=>{const t=y(o),i=F(o,"scraps",e),p=F(o,"users",f.id);C[e]?(t.update(i,{likes:u-1}),t.update(p,{likeScraps:f.likeScraps.filter(l=>l.match(e)==null)})):(t.update(i,{likes:u+1}),t.update(p,{likeScraps:[...f.likeScraps,e]})),t.commit(),x(l=>({...l,[e]:![e]}))},U=async(e,u)=>{const t=y(o),i=F(o,"scraps",e),p=F(o,"users",f.id);S[e]?(t.update(i,{goods:u-1}),t.update(p,{goodScraps:f.goodScraps.filter(l=>l.match(e)==null)})):(t.update(i,{goods:u+1}),t.update(p,{goodScraps:[...f.goodScraps,e]})),t.commit(),A(l=>({...l,[e]:![e]}))};c.exports.useEffect(()=>{if(!n.user)window.location="/login";else{const e=E(2)(N);h(e);const u=k(o,"users");b(q(u,P("pt","desc"),W(10)),t=>{H(t.docs.map(i=>({...i.data()})))}),b(k(o,"users"),t=>{t.docs.map(i=>{i.data().email===n.user.email&&(j(i.data()),b(k(o,"scraps"),p=>{p.docs.map(l=>{i.data().likeScraps.length>0?i.data().likeScraps.includes(l.id)?x(r=>({...r,[l.id]:!0})):x(r=>({...r,[l.id]:!1})):x(r=>({...r,[l.id]:!1})),i.data().goodScraps?i.data().goodScraps.includes(l.id)?A(r=>({...r,[l.id]:!0})):A(r=>({...r,[l.id]:!1})):A(r=>({...r,[l.id]:!1}))})}))})}),L(!1)}},[n]);const z=async e=>{D.fire({title:"\u30B9\u30AF\u30E9\u30C3\u30D7\u306E\u524A\u9664",html:"<strong>\u672C\u5F53\u306B\u5B9F\u884C\u3057\u3066\u3082\u3088\u308D\u3057\u3044\u3067\u3059\u304B\uFF1F</strong>",icon:"warning",showCancelButton:!0,allowOutsideClick:!1,allowEscapeKey:!1,confirmButtonText:"\u7D9A\u3051\u308B",cancelButtonText:"\u3084\u3081\u308B",confirmButtonColor:"#d33",reverseButtons:!0}).then(async u=>{!u.value||(await Q(F(o,"scraps",e)),D.fire({title:"\u51E6\u7406\u7D42\u4E86",html:"\u9078\u629E\u3057\u305F\u30B9\u30AF\u30E9\u30C3\u30D7\u304C\u524A\u9664\u3055\u308C\u307E\u3057\u305F\u3002",icon:"success",allowOutsideClick:!1,allowEscapeKey:!1}))})};switch(O){case!1:return a("div",{className:"scraps-wrapper",children:a("div",{className:"displayQuestions",children:s("div",{className:"flexbox",children:[s("div",{className:"Ranking",children:[a("h3",{children:"\u30E6\u30FC\u30B6\u30FC\u30E9\u30F3\u30AD\u30F3\u30B0"}),w&&w.map((e,u)=>a("div",{className:"user ranking-wrapper",children:s("a",{href:"/profile?user="+e.displayName,children:[u+1===1?s("div",{className:"fs-4 fw-bold",children:[a("i",{className:"fa-sharp fa-solid fa-crown me-2 ranking-first d-inline"}),s("p",{className:"d-inline text-dark",children:[u+1," \u4F4D\u3000",a("img",{className:"ranking-userIcon",src:e.icon,alt:"userIcon"}),e.displayName,a("span",{className:"mx-2",children:e.pt}),"points"]})]}):u+1===2?s("div",{className:"fs-5 fw-bold",children:[a("i",{className:"fa-sharp fa-solid fa-crown me-2 ranking-second d-inline"}),s("p",{className:"d-inline text-dark",children:[u+1," \u4F4D\u3000",a("img",{className:"ranking-userIcon",src:e.icon,alt:"userIcon"}),e.displayName,a("span",{className:"mx-2",children:e.pt}),"points"]})]}):u+1===3?s("div",{className:"fs-6 fw-bold",children:[a("i",{className:"fa-sharp fa-solid fa-crown me-2 ranking-third d-inline"}),s("p",{className:"d-inline text-dark",children:[u+1," \u4F4D\u3000",a("img",{className:"ranking-userIcon",src:e.icon,alt:"userIcon"}),e.displayName,a("span",{className:"mx-2",children:e.pt}),"points"]})]}):a("div",{children:s("p",{className:"d-inline text-dark",children:[u+1," \u4F4D\u3000",a("img",{className:"ranking-userIcon",src:e.icon,alt:"userIcon"}),e.displayName,a("span",{className:"mx-2",children:e.pt}),"points"]})}),a("hr",{className:"ranking-bottomHr"})]})},e.displayName))]}),s("div",{className:"Scraps",children:[a("h2",{className:"scraps-title",children:"Scraps Board"}),a("p",{className:"text-center",children:"\u7591\u554F\u3092\u30A8\u30F3\u30B8\u30CB\u30A2\u306B\u76F8\u8AC7\u3067\u304D\u307E\u3059\u3002"}),s("p",{className:"text-center",children:["\u691C\u7D22\u7D50\u679C: ",B.length,"\u4EF6"]}),B.length?B.map(e=>s("div",{className:"scrap",children:[a("a",{href:"/profile?user="+e.userName,children:a("img",{className:"scrap-userIcon",src:e.userIcon,alt:"userIcon"})}),s("p",{className:"scrap-userName",children:[a("i",{className:"fas fa-circle-question"}),"\u30B9\u30AF\u30E9\u30C3\u30D7\u6295\u7A3F\u8005 \u21E2 ",a("a",{href:"/profile?user="+e.userName,children:e.userName})]}),a("p",{className:"scrap-createAt",children:e.createAt}),a("div",{className:"scrap-good ps-1",children:a(I,{label:"\u3044\u3044\u306D\uFF01",bg:"gray",p:"0px 10px",fontSize:"11px",color:"white",children:s(v,{cursor:"pointer",onClick:()=>U(e.id,e.goods),children:[a(R,{as:S[e.id]?_:J,mr:"2.5",fontSize:"22px",color:S[e.id]?"#80CBC4":""}),e.goods]})})}),a("div",{className:"scrap-like ps-2",children:a(I,{label:"\u304A\u6C17\u306B\u5165\u308A\u306B\u8FFD\u52A0",bg:"gray",p:"0px 10px",fontSize:"11px",color:"white",children:s(v,{cursor:"pointer",onClick:()=>M(e.id,e.likes),children:[a(R,{as:C[e.id]?V:Y,mr:"2.5",fontSize:"22px",color:C[e.id]?"red":""}),e.likes]})})}),a("h1",{className:"scrap-title",children:e.title}),a("p",{className:"scrap-content",id:"scrap-content",children:e.subtitle&&e.subtitle.length>20?e.subtitle.slice(0,80)+"\u2026":e.subtitle}),s("p",{children:["\u8A00\u8A9E: ",e.languages&&e.languages.join(", ")]}),s("p",{children:["\u305D\u306E\u4ED6: ",e.others&&e.others.join(", ")]}),s("div",{className:e.uid===n.user.uid?"scraps-btn-wrapper":"",children:[a("a",{href:"/scraps/detail?user="+e.userName+"&id="+e.id,children:a("button",{className:"btn",children:"\u8A73\u7D30\u3092\u78BA\u8A8D"})}),e.uid===n.user.uid&&s("button",{className:"btn btn-danger",onClick:()=>z(e.id),children:[a("i",{className:"fas fa-xmark me-2"}),"\u3053\u306E\u30B9\u30AF\u30E9\u30C3\u30D7\u3092\u524A\u9664\u3059\u308B"]})]})]},e.title)):s("div",{className:"noResults-wrapper",children:[a("h5",{children:"\u691C\u7D22\u7D50\u679C\u306B\u8A72\u5F53\u3059\u308B\u30C7\u30FC\u30BF\u304C\u3042\u308A\u307E\u305B\u3093\u3002"}),a("h5",{children:"\u30AD\u30FC\u30EF\u30FC\u30C9\u3092\u5909\u66F4\u3057\u3066\u518D\u5EA6\u691C\u7D22\u3092\u3057\u3066\u307F\u3066\u304F\u3060\u3055\u3044\u3002"})]})]})]})})});default:return null}};export{ae as default};
