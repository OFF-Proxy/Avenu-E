import{D as d,b as n,R as f,j as e,a as l,d as r,m as F,n as x,p as q,q as H,T as v,t as S,f as A,v as R,x as y,M as g}from"./index.61613632.js";import{q as G}from"./index.49b092ce.js";/* empty css                */const X=u=>{const k=d(r,"users"),[i,U]=n.exports.useState(Object()),[z,I]=n.exports.useState(Array()),[L,O]=n.exports.useState(Boolean(!0)),[p,j]=n.exports.useState(null),[a,B]=n.exports.useState({displayName:String(),introduce:String(),twitter:String(),github:String()}),[N,D]=n.exports.useState(Array()),[E,K]=n.exports.useState(String()),P=d(r,"languages");n.exports.useEffect(()=>{u.user?u.user.emailVerified?(f(k,s=>{s.docs.map(t=>{t.data().email===u.user.email&&U(t.data())})}),f(P,s=>{I(s.docs.map(t=>({...t.data().name})))}),O(!1)):noVerifiedAccount():window.location="/login"},[u]),n.exports.useEffect(()=>{B({displayName:i.displayName,introduce:i.introduce,twitter:String(i.twitter).replace("https://twitter.com/",""),github:String(i.github).replace("https://github.com/","")}),i.skill&&D(i.skill.map(s=>s))},[i]);const M=async s=>{if(s.preventDefault(),a.introduce.length<=50)try{if(p){const t=F(x,p.icon.name);q(t,p.icon).then(()=>{const o=F(x,`gs://avenu-e.appspot.com/${p.icon.name}`);H(o).then(async c=>{const w=d(r,"scraps");f(w,V=>{V.docs.map(async C=>{if(C.data().uid===u.user.uid){const $=d(r,"scraps",C.id);await v($,{userIcon:c,userName:u.user.displayName})}})}),S(A.currentUser,{photoURL:c,displayName:a.displayName});const m=R(r),b=y(r,"users",i.id);m.update(b,{icon:c,displayName:a.displayName,skill:N,introduce:a.introduce,twitter:"https://twitter.com/"+a.twitter,github:"https://github.com/"+a.github}),await m.commit(),await g.fire({title:"\u66F4\u65B0\u5B8C\u4E86",html:"\u30D7\u30ED\u30D5\u30A3\u30FC\u30EB\u304C\u65B0\u3057\u304F\u306A\u308A\u307E\u3057\u305F\u3002",icon:"success",allowOutsideClick:!1,allowEscapeKey:!1}).then(()=>{window.location=`/profile?user=${u.user.displayName}`})}).catch(c=>{console.log(c)})})}else{S(A.currentUser,{displayName:a.displayName});const t=d(r,"scraps");f(t,w=>{w.docs.map(async m=>{if(m.data().uid===u.user.uid){const b=y(r,"scraps",m.id);await v(b,{userName:a.displayName})}})});const o=R(r),c=y(r,"users",i.id);o.update(c,{displayName:a.displayName,skill:N,introduce:a.introduce,twitter:a.twitter.trim()&&"https://twitter.com/"+a.twitter,github:a.github.trim()&&"https://github.com/"+a.github}),await o.commit(),await g.fire({title:"\u66F4\u65B0\u5B8C\u4E86\u3002",html:"\u30D7\u30ED\u30D5\u30A3\u30FC\u30EB\u304C\u65B0\u3057\u304F\u306A\u308A\u307E\u3057\u305F\u3002",icon:"success",allowOutsideClick:!1,allowEscapeKey:!1}).then(()=>{window.location=`/profile?user=${u.user.displayName}`})}}catch(t){await g.fire({title:t,html:"\u30A2\u30AB\u30A6\u30F3\u30C8\u5909\u66F4\u304C\u6B63\u5E38\u306B\u5B9F\u884C\u3055\u308C\u307E\u305B\u3093\u3067\u3057\u305F\u3002",icon:"error",allowOutsideClick:!1,allowEscapeKey:!1})}else g.fire({title:"",html:"\u81EA\u5DF1\u7D39\u4ECB\u306F50\u6587\u5B57\u4EE5\u5185\u3067\u3054\u8A18\u5165\u304F\u3060\u3055\u3044\u3002",icon:"error",allowOutsideClick:!1,allowEscapeKey:!1})},T=s=>{j({icon:s.target.files[0]});const t=new FileReader;t.readAsDataURL(s.target.files[0]),t.onload=()=>{K(t.result)}},h=s=>{const t=s.target,o=t.value,c=t.name;B({...a,[c]:o})};switch(L){case!1:return e("form",{className:"container my-5",onSubmit:M,children:l("div",{className:"editProfile-wrapper",children:[e("div",{className:"text-center",children:l("label",{className:"edit-masterUserIcon-wrapper",children:[e("i",{className:"fa-solid fa-camera fa-3x"}),e("img",{className:"masterUserIcon",src:E||i.icon}),e("input",{className:"d-none",type:"file",accept:"image/*",onChange:T})]})}),l("div",{className:"w-50 m-auto",children:[l("div",{className:"mb-2",children:[e("label",{className:"form-label",children:"\u540D\u524D"}),e("input",{className:"form-control",type:"text",name:"displayName",value:a.displayName,onChange:h,placeholder:"\u30E6\u30FC\u30B6\u30FC\u540D"})]}),l("div",{className:"mb-2",children:[e("label",{className:"form-label",children:"\u30B9\u30AD\u30EB"}),e(G,{classNames:"tag-form",value:N,onChange:D,name:"skills",placeHolder:"\u30BF\u30B0\u306E\u8FFD\u52A0"})]}),l("div",{className:"mb-2 sns-wrapper",children:[e("label",{className:"form-label",children:"SNS"}),l("div",{className:"input-group mb-2",children:[e("i",{className:"fa-brands fa-twitter fa-2x me-2 icon"}),e("span",{className:"input-group-text",children:"https://twitter.com/"}),e("input",{className:"form-control",type:"text",name:"twitter",value:a.twitter,onChange:h,placeholder:"Twitter \u30E6\u30FC\u30B6\u30FC\u540D"})]}),l("div",{className:"input-group mb-2",children:[e("i",{className:"fa-brands fa-github-alt fa-2x me-2 icon"}),e("span",{className:"input-group-text",children:"https://github.com/"}),e("input",{className:"form-control",type:"text",name:"github",value:a.github,onChange:h,placeholder:"GitHub \u30E6\u30FC\u30B6\u30FC\u540D"})]})]}),l("div",{className:"mb-2",children:[e("label",{className:"form-label",children:"\u81EA\u5DF1\u7D39\u4ECB"}),e("textarea",{className:"form-control",name:"introduce",value:a.introduce,onChange:h,maxLength:50,placeholder:"\u81EA\u5DF1\u7D39\u4ECB\u5185\u5BB9 ( 50\u6587\u5B57\u4EE5\u5185 )"})]})]}),l("div",{className:"text-center mt-4",children:[e("a",{className:"btn btn-secondary me-4",href:"/profile?user="+u.user.displayName,children:"\u3084\u3081\u308B"}),e("button",{className:"btn btn-success ms-4",children:"\u4FDD\u5B58\u3059\u308B"})]})]})});default:return null}};export{X as default};
